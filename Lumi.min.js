var Lumi=function(){console.error("LumiJS: Lumi has no object to work with")};Lumi.canvas=document.createElement("CANVAS"),Lumi.canvas.id="canvas",document.body.appendChild(Lumi.canvas);const ctx=Lumi.canvas.getContext("2d");document.body.style.overflow="hidden",Lumi.canvasCheck={width:"normal",height:"normal"},Lumi.objects=[],Lumi.gravity=0,Lumi.cameraType="side",Lumi.random=function(i,t){return Math.random()*(t-i)+i},Lumi.checkCollision=function(i,t){if("rect"==i.type&&"rect"==t.type)return i.x<t.x+t.width&&i.x+i.width>t.x&&i.y<t.y+t.height&&i.y+i.height>t.y},Lumi.rect=function(i,t,e,s,o){o||(o={mass:1,maxVel:{x:45,y:45},restitution:0,static:!1,collision:!0,color:"#000000",collisionType:"dynamic"}),o.mass||(o.mass=1),o.maxVel||(o.maxVel={x:45,y:45}),o.maxVel.x||(o.maxVel.x=45),o.maxVel.y||(o.maxVel.y=45),o.restitution||(o.restitution=0),o.static||(o.static=!1),o.collision||(o.collision=!0),o.color||(o.color="#000000"),o.collisionType||(o.collisionType="dynamic"),this.type="rect",this.collisionType=o.collisionType,this.x=i,this.y=t,this.width=e,this.height=s,this.halfWidth=this.width/2,this.halfHeight=this.height/2,this.color=o.color,this.restitution=o.restitution,this.static=o.static,this.collision=o.collision,this.mass=o.mass,this.velocity={x:0,y:0,increase:{x:0,y:0}},this.gravity=Lumi.gravity,this.maxVel={x:o.maxVel.x,y:o.maxVel.y},this.addXVel=function(i){this.velocity.x+=i},this.addYVel=function(i){this.velocity.y+=i},this.getMidX=function(){return this.halfWidth+this.x},this.getMidY=function(){return this.halfHeight+this.y},this.getTop=function(){return this.y},this.getLeft=function(){return this.x},this.getRight=function(){return this.x+this.width},this.getBottom=function(){return this.y+this.height},this.update=function(){this.halfWidth=.5*this.width,this.halfHeight=.5*this.height,this.x+=this.velocity.x,this.y+=this.velocity.y,this.y<=window.innerHeight-this.height?(this.gravity=Lumi.gravity,this.velocity.x>=this.maxVel.x&&(this.velocity.x=this.maxVel.x,this.velocity.increase.x=0),this.velocity.y>=this.maxVel.y?(this.velocity.y=this.maxVel.y,this.velocity.increase.y=0):this.static||(this.velocity.y=this.gravity*this.mass+this.velocity.increase.y,this.velocity.increase.y+=1)):(this.velocity.increase.y=0,this.gravity=0,this.y=window.innerHeight-this.height);for(var i=0;i<Lumi.objects.length;i++)this!=Lumi.objects[i]&&this.collision&&Lumi.objects[i].collision&&Lumi.checkCollision(this,Lumi.objects[i])&&(this.getMidY()<Lumi.objects[i].getMidY()&&(this.velocity.increase.y=0,this.gravity=0),Lumi.resolveCollision(this,Lumi.objects[i]))},this.updateOver=function(){for(var i=0;i<Lumi.objects.length;i++)this!=Lumi.objects[i]&&this.collision&&Lumi.objects[i].collision&&Lumi.checkCollision(this,Lumi.objects[i])&&(this.getMidY()<Lumi.objects[i].getMidY()&&(this.velocity.increase.y=0,this.gravity=0),Lumi.resolveCollision(this,Lumi.objects[i]))}},Lumi.ellipse=function(i,t,e,s){s||(s={mass:1,maxVel:{x:45,y:45},restitution:0,static:!1,collision:!0,color:"#000000",collisionType:"dynamic"}),s.mass||(s.mass=1),s.maxVel||(s.maxVel={x:45,y:45}),s.maxVel.x||(s.maxVel.x=45),s.maxVel.y||(s.maxVel.y=45),s.restitution||(s.restitution=0),s.static||(s.static=!1),s.collision||(s.collision=!0),s.color||(s.color="#000000"),s.collisionType||(s.collisionType="dynamic"),this.type="ellipse",this.collisionType=s.collisionType,this.x=i,this.y=t,this.radius=e,this.color=s.color,this.restitution=s.restitution,this.static=s.static,this.collision=s.collision,this.mass=s.mass,this.velocity={x:0,y:0,increase:{x:0,y:0}},this.gravity=Lumi.gravity,this.maxVel={x:s.maxVel.x,y:s.maxVel.y},this.addXVel=function(i){this.velocity.x+=i},this.addYVel=function(i){this.velocity.y+=i},this.getMidX=function(){return this.x},this.getMidY=function(){return this.y},this.getTop=function(){return this.y-this.radius},this.getLeft=function(){return this.x-this.radius},this.getRight=function(){return this.x+this.radius},this.getBottom=function(){return this.y+this.radius},this.update=function(){this.x+=this.velocity.x,this.y+=this.velocity.y,this.y<=window.innerHeight-this.radius?(this.gravity=Lumi.gravity,this.velocity.x>=this.maxVel.x&&(this.velocity.x=this.maxVel.x,this.velocity.increase.x=0),this.velocity.y>=this.maxVel.y?(this.velocity.y=this.maxVel.y,this.velocity.increase.y=0):this.static||(this.velocity.y=this.gravity*this.mass+this.velocity.increase.y,this.velocity.increase.y+=1)):(this.velocity.increase.y=0,this.gravity=0,this.y=window.innerHeight-this.radius);for(var i=0;i<Lumi.objects.length;i++)this!=Lumi.objects[i]&&this.collision&&Lumi.objects[i].collision&&Lumi.checkCollision(this,Lumi.objects[i])&&(this.getMidY()<Lumi.objects[i].getMidY()&&(this.velocity.increase.y=0,this.gravity=0),Lumi.resolveCollision(this,Lumi.objects[i]))},this.updateOver=function(){for(var i=0;i<Lumi.objects.length;i++)this!=Lumi.objects[i]&&this.collision&&Lumi.objects[i].collision&&Lumi.checkCollision(this,Lumi.objects[i])&&(this.getMidY()<Lumi.objects[i].getMidY()&&(this.velocity.increase.y=0,this.gravity=0),Lumi.resolveCollision(this,Lumi.objects[i]))}},Lumi.img=function(i,t,e,s,o,h){h||(h={mass:1,maxVel:{x:45,y:45},restitution:0,static:!1,collision:!0,color:"#000000",collisionType:"dynamic"}),h.mass||(h.mass=1),h.maxVel||(h.maxVel={x:45,y:45}),h.maxVel.x||(h.maxVel.x=45),h.maxVel.y||(h.maxVel.y=45),h.restitution||(h.restitution=0),h.static||(h.static=!1),h.collision||(h.collision=!0),h.color||(h.color="#000000"),h.collisionType||(h.collisionType="dynamic"),this.type="img",this.collisionType=h.collisionType,this.img=i,this.x=t,this.y=e,this.width=s,this.height=o,this.halfWidth=this.width/2,this.halfHeight=this.height/2,this.color=h.color,this.restitution=h.restitution,this.static=h.static,this.collision=h.collision,this.mass=h.mass,this.velocity={x:0,y:0,increase:{x:0,y:0}},this.gravity=Lumi.gravity,this.maxVel={x:h.maxVel.x,y:h.maxVel.y},this.addXVel=function(i){this.velocity.x+=i},this.addYVel=function(i){this.velocity.y+=i},this.getMidX=function(){return this.halfWidth+this.x},this.getMidY=function(){return this.halfHeight+this.y},this.getTop=function(){return this.y},this.getLeft=function(){return this.x},this.getRight=function(){return this.x+this.width},this.getBottom=function(){return this.y+this.height},this.update=function(){this.halfWidth=.5*this.width,this.halfHeight=.5*this.height,this.x+=this.velocity.x,this.y+=this.velocity.y,this.y<=window.innerHeight-this.height?(this.gravity=Lumi.gravity,this.velocity.x>=this.maxVel.x&&(this.velocity.x=this.maxVel.x,this.velocity.increase.x=0),this.velocity.y>=this.maxVel.y?(this.velocity.y=this.maxVel.y,this.velocity.increase.y=0):this.static||(this.velocity.y=this.gravity*this.mass+this.velocity.increase.y,this.velocity.increase.y+=1)):(this.velocity.increase.y=0,this.gravity=0,this.y=window.innerHeight-this.height);for(var i=0;i<Lumi.objects.length;i++)this!=Lumi.objects[i]&&this.collision&&Lumi.objects[i].collision&&Lumi.checkCollision(this,Lumi.objects[i])&&(this.getMidY()<Lumi.objects[i].getMidY()&&(this.velocity.increase.y=0,this.gravity=0),Lumi.resolveCollision(this,Lumi.objects[i]))},this.updateOver=function(){for(var i=0;i<Lumi.objects.length;i++)this!=Lumi.objects[i]&&this.collision&&Lumi.objects[i].collision&&Lumi.checkCollision(this,Lumi.objects[i])&&(this.getMidY()<Lumi.objects[i].getMidY()&&(this.velocity.increase.y=0,this.gravity=0),Lumi.resolveCollision(this,Lumi.objects[i]))}},Lumi.addRect=function(i,t,e,s,o){return Lumi.objects.push(new Lumi.rect(i,t,e,s,o)),Lumi.objects[Lumi.objects.length-1]},Lumi.addEllipse=function(i,t,e,s){return Lumi.objects.push(new Lumi.ellipse(i,t,e,s)),Lumi.objects[Lumi.objects.length-1]},Lumi.addImg=function(i,t,e,s,o,h){return Lumi.objects.push(new Lumi.img(i,t,e,s,o,h)),Lumi.objects[Lumi.objects.length-1]},Lumi.resolveCollision=function(i,t){if(Lumi.checkCollision(i,t)){if("dynamic"==i.collisionType&&"fixed"==t.collisionType){var e=i.getMidX(),s=i.getMidY(),o=t.getMidX(),h=t.getMidY(),c=(o-e)/t.halfWidth,l=(h-s)/t.halfHeight,n=Math.abs(c),a=Math.abs(l);Math.abs(n-a)<.1?(i.x=c<0?t.getRight():t.getLeft()-i.width,i.y=l<0?t.getBottom():t.getTop()-i.height,Math.random()<.5?(i.velocity.x=-i.velocity.x*t.restitution,Math.abs(i.velocity.x)<4e-4&&(i.velocity.x=0)):(i.velocity.y=-i.velocity.y*t.restitution,Math.abs(i.velocity.y)<4e-4&&(i.velocity.y=0))):n>a?(i.x=c<0?t.getRight():t.getLeft()-i.width,i.velocity.x=-i.velocity.x*t.restitution,Math.abs(i.velocity.x)<4e-4&&(i.velocity.x=0)):(l<0?i.y=t.getBottom():(i.velocity.y=0,i.y=t.getTop()-i.height),i.velocity.y=-i.velocity.y*t.restitution,Math.abs(i.velocity.y)<4e-4&&(i.velocity.y=0))}else if("dynamic"==i.type&&"dynamic"==t.type){e=i.getMidX(),s=i.getMidY(),o=t.getMidX(),h=t.getMidY(),c=(o-e)/t.halfWidth,l=(h-s)/t.halfHeight,n=Math.abs(c),a=Math.abs(l);Math.abs(n-a)<.1?(i.x=c<0?t.getRight():t.getLeft()-i.width,i.y=l<0?t.getBottom():t.getTop()-i.height,Math.random()<.5?(i.velocity.x=-i.velocity.x*t.restitution,Math.abs(i.velocity.x)<4e-4&&(i.velocity.x=0)):(i.velocity.y=-i.velocity.y*t.restitution,Math.abs(i.velocity.y)<4e-4&&(i.velocity.y=0))):n>a?(i.x=c<0?t.getRight():t.getLeft()-i.width,i.velocity.x=-i.velocity.x*t.restitution,Math.abs(i.velocity.x)<4e-4&&(i.velocity.x=0)):(l<0?i.y=t.getBottom():(i.velocity.y=0,i.y=t.getTop()-i.height),i.velocity.y=-i.velocity.y*t.restitution,Math.abs(i.velocity.y)<4e-4&&(i.velocity.y=0))}}else console.error("LumiJS: No Collision To Resolve")},Lumi.config=function(i,t,e,s){i||(i=400),"fitToWindow"==i&&(i=window.innerWidth,Lumi.canvasCheck.width="fitToWindow"),t||(t=400),"fitToWindow"==t&&(t=window.innerHeight,Lumi.canvasCheck.height="fitToWindow"),e||(e=0),s||(s="side"),Lumi.canvas.width=i,Lumi.canvas.height=t,Lumi.gravity=e,Lumi.cameraType=s},Lumi.resize=function(){"fitToWindow"==Lumi.canvasCheck.width&&(Lumi.canvas.width=window.innerWidth),"fitToWindow"==Lumi.canvasCheck.height&&(Lumi.canvas.height=window.innerHeight)},window.onresize=Lumi.resize,Lumi.renderFrame=function(){scrollTo(10,10),ctx.clearRect(0,0,window.innerWidth,window.innerHeight);for(var i=0;i<Lumi.objects.length;i++)"rect"===Lumi.objects[i].type?(ctx.fillStyle=Lumi.objects[i].color,ctx.fillRect(Lumi.objects[i].x,Lumi.objects[i].y,Lumi.objects[i].width,Lumi.objects[i].height),"overhead"!==Lumi.cameraType?Lumi.objects[i].update():Lumi.objects[i].updateOver(),ctx.fillStyle="#000000"):"ellipse"===Lumi.objects[i].type?(ctx.beginPath(),ctx.arc(Lumi.objects[i].x,Lumi.objects[i].y,Lumi.objects[i].radius,0,2*Math.PI,!1),ctx.fillStyle=Lumi.objects[i].color,ctx.fill(),"overhead"!==Lumi.cameraType?Lumi.objects[i].update():Lumi.objects[i].updateOver(),ctx.fillStyle="#000000"):"img"===Lumi.objects[i].type&&(ctx.drawImage(Lumi.objects[i].img,Lumi.objects[i].x,Lumi.objects[i].y,Lumi.objects[i].width,Lumi.objects[i].height),"overhead"!==Lumi.cameraType?Lumi.objects[i].update():Lumi.objects[i].updateOver())},Lumi.init=function(){requestAnimationFrame(Lumi.init),Lumi.renderFrame()};